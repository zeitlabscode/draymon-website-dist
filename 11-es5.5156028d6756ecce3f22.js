function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{pBEy:function(e,t,n){"use strict";n.r(t),n.d(t,"AddSlotModule",(function(){return x}));var o=n("ofXK"),i=n("PSD3"),r=n.n(i),a=n("3Pt+"),s=n("fXoL"),d=n("N+K7"),l=n("dz5x"),c=n("IvIE"),u=["monthCalendar"],b=["dayCalendar"];function m(e,t){if(1&e){var n=s.Pb();s.Ob(0,"button",19),s.Wb("click",(function(){return s.jc(n),s.Yb().showDay=!1})),s.oc(1," Go Back "),s.Nb()}}function h(e,t){if(1&e&&s.Kb(0,"full-calendar",20,21),2&e){var n=s.Yb();s.ec("options",n.calendarOptionsMonth)}}function f(e,t){if(1&e&&s.Kb(0,"full-calendar",20,22),2&e){var n=s.Yb();s.ec("options",n.calendarOptionsDay)}}var p,v=((p=function(){function e(t,n){_classCallCheck(this,e),this.http=t,this.share=n,this.form=new a.e({adminId:new a.c(this.share.user,{validators:[a.p.required]}),date:new a.c(null,{validators:[a.p.required]}),startTime:new a.c(null,{validators:[a.p.required]}),endTime:new a.c(null,{validators:[a.p.required]}),startTimeStr:new a.c(null,{validators:[a.p.required]}),endTimeStr:new a.c(null,{validators:[a.p.required]}),duration:new a.c(null,{validators:[a.p.required]}),title:new a.c(null,{validators:[a.p.required]})}),this.selectedDate="",this.bookedEvents=[],this.monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sepr","Oct","Novr","Dec"],this.calendarOptionsMonth={headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,listMonth"},initialView:"dayGridMonth",eventClick:this.deleteEvent.bind(this),dateClick:this.dateClick.bind(this),eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!0},displayEventEnd:!0,events:this.bookedEvents},this.calendarOptionsDay={initialDate:this.selectedDate,initialView:"timeGridDay",editable:!0,selectable:!0,select:this.selectTime.bind(this),eventClick:this.deleteEvent.bind(this),events:this.bookedEvents,slotDuration:"00:60:00"}}return _createClass(e,[{key:"ngOnInit",value:function(){var e=this;this.showDay=!1,this.http.postToBackend("/admin/slot/all",{adminId:this.share.user}).then((function(t){console.log("original",t),e.bookedEvents=t.data.map((function(e){return{id:e.id,date:new Date(e.date),booked:e.booked,title:e.booked?e.title+" (Booked)":e.title,transactionId:e.booked?e.transactionId:null,start:e.startTime,end:e.endTime,allDay:!1}})),e.calendarOptionsMonth.events=e.bookedEvents,e.calendarOptionsDay.events=e.bookedEvents,console.log("converted",e.bookedEvents)}))}},{key:"dateClick",value:function(e){this.currentDate=e.date,this.selectedDate=e.dateStr,this.calendarOptionsDay.initialDate=this.selectedDate,this.showDay=!0}},{key:"selectTime",value:function(e){this.currentEvent=e,this.currentEvent.date=this.currentDate,this.currentEvent.booked=!1,this.calendarApi=e.view.calendar,this.calendarApi.unselect(),console.log("current event - ",this.currentEvent);var t=this.findDuration(this.currentEvent.startStr,this.currentEvent.endStr);this.currentEvent.duration=t,60==t?$("#slot-modal").modal("toggle"):r.a.fire("Invalid Slot","Slot duration can only be of 60 minutes.","error")}},{key:"addSlot",value:function(){var e=this;$("#confirm-btn").addClass("running"),$("#confirm-btn").prop("disabled",!0);var t=this.currentEvent.start.getMonth(),n=this.currentEvent.start.getYear(),o=1;this.bookedEvents.forEach((function(e){e.date.getMonth()==t&&e.date.getYear()==n&&o++})),this.form.patchValue({date:this.currentEvent.date,title:"".concat(this.monthNames[t]," Slot - ").concat(o),startTimeStr:this.currentEvent.startStr,endTimeStr:this.currentEvent.endStr,duration:this.currentEvent.duration,startTime:this.currentEvent.start,endTime:this.currentEvent.end}),this.currentEvent.title="".concat(this.monthNames[t]," Slot - ").concat(o),console.log("this form",this.form.value),this.http.postToBackend("/admin/slot/create",this.form.value).then((function(t){$("#confirm-btn").removeClass("running"),$("#confirm-btn").prop("disabled",!1),$("#slot-modal").modal("toggle"),console.log(t),7e3==t.statusCode?(r.a.fire({icon:"success",title:"Slot Created"}),e.bookedEvents.push(e.currentEvent),e.calendarApi.addEvent(e.currentEvent)):r.a.fire({icon:"error",title:"Oops",text:t.message})})).catch((function(e){console.log(e),$("#confirm-btn").removeClass("running"),$("#confirm-btn").prop("disabled",!1),$("#slot-modal").modal("toggle"),r.a.fire({icon:"error",title:"Can't create a slot",text:e.message})}))}},{key:"deleteEvent",value:function(e){var t=this;this.calendarApi=e.view.calendar,this.calendarApi.unselect();var n=e.event._def.publicId,o=this.bookedEvents.findIndex((function(t){return t.id==e.event._def.publicId}));this.bookedEvents.splice(o,1);var i=this.calendarApi.getEventById(n),a=i._def.extendedProps.transactionId;i._def.extendedProps.booked?r.a.fire({icon:"question",title:"Delete this slot?",text:"This slot is booked. Removing it will require refund for the slot. Do you still want to remove it?",showCancelButton:!0,confirmButtonText:"Yes, delete this slot!"}).then((function(e){e.value&&t.http.postToBackend("/admin/refund",{adminId:t.share.user,slotId:n,transactionId:a}).then((function(e){console.log(e),7e3===e.statusCode?(t.bookedEvents.splice(o,1),i.remove(),r.a.fire("Deleted","Slot deleted successfully. Refund Initiated","success")):r.a.fire("Failed!",e.message,"error")})).catch((function(e){console.log(e),r.a.fire("Oops",e.message,"error")}))})):r.a.fire({icon:"question",title:"Delete this slot?",showCancelButton:!0,confirmButtonText:"Yes, delete this slot!"}).then((function(e){e.value&&t.http.postToBackend("/admin/slot/delete",{adminId:t.share.user,slotId:n}).then((function(e){console.log(e),e.statusCode?(r.a.fire("Deleted","Slot Deleted Successfully","success"),t.bookedEvents.splice(o,1),i.remove()):r.a.fire("Failed","Failed to delete slot","error")})).catch((function(e){console.log(e),r.a.fire("Failed","Failed to delete slot","error")})),console.log(e.value,n)}))}},{key:"findDuration",value:function(e,t){var n=new Date(e),o=(new Date(t).getTime()-n.getTime())/1e3;return Math.abs(Math.round(o/=60))}}]),e}()).\u0275fac=function(e){return new(e||p)(s.Jb(d.a),s.Jb(l.a))},p.\u0275cmp=s.Db({type:p,selectors:[["app-add-slot"]],viewQuery:function(e,t){var n;1&e&&(s.tc(u,!0),s.tc(b,!0)),2&e&&(s.ic(n=s.Xb())&&(t.monthCalendar=n.first),s.ic(n=s.Xb())&&(t.dayCalendar=n.first))},decls:39,vars:16,consts:[[1,"d-flex","align-items-center","justify-content-between","mb-5"],[1,"text-dark","text-center"],["class","btn btn-sm btn-dark mt-0",3,"click",4,"ngIf"],[1,"calendar-container"],[3,"options",4,"ngIf"],["id","slot-modal",1,"modal"],[1,"modal-dialog","modal-md"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title","text-dark","text-center"],["type","button","data-dismiss","modal",1,"close"],[1,"modal-body","text-center"],[1,"text","mb-2"],[1,"text-700"],[1,"text","mb-5"],[1,"modal-footer"],["type","button","id","confirm-btn",1,"btn","btn-sm","btn-primary","ld-ext-right",3,"click"],[1,"ld","ld-ring","ld-spin-fast"],["type","button","data-dismiss","modal",1,"btn","btn-sm","btn-dark"],[1,"btn","btn-sm","btn-dark","mt-0",3,"click"],[3,"options"],["monthCalendar",""],["dayCalendar",""]],template:function(e,t){1&e&&(s.Ob(0,"div",0),s.Ob(1,"h3",1),s.oc(2," Book new meeting slots "),s.Nb(),s.nc(3,m,2,0,"button",2),s.Nb(),s.Ob(4,"div",3),s.nc(5,h,2,1,"full-calendar",4),s.nc(6,f,2,1,"full-calendar",4),s.Nb(),s.Ob(7,"div",5),s.Ob(8,"div",6),s.Ob(9,"div",7),s.Ob(10,"div",8),s.Ob(11,"h4",9),s.oc(12,"Add this slot ?"),s.Nb(),s.Ob(13,"button",10),s.oc(14,"\xd7"),s.Nb(),s.Nb(),s.Ob(15,"div",11),s.Ob(16,"h5",1),s.oc(17," Slot Timings "),s.Nb(),s.Ob(18,"p",12),s.Ob(19,"span",13),s.oc(20,"Date: "),s.Nb(),s.oc(21),s.Zb(22,"date"),s.Nb(),s.Ob(23,"p",14),s.Ob(24,"span",13),s.oc(25,"Time: "),s.Nb(),s.oc(26),s.Zb(27,"date"),s.Zb(28,"date"),s.Nb(),s.Ob(29,"p",14),s.Ob(30,"span",13),s.oc(31,"Duration: "),s.Nb(),s.oc(32),s.Nb(),s.Nb(),s.Ob(33,"div",15),s.Ob(34,"button",16),s.Wb("click",(function(){return t.addSlot()})),s.Kb(35,"div",17),s.oc(36," Confirm this slot"),s.Nb(),s.Ob(37,"button",18),s.oc(38,"No"),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&e&&(s.zb(3),s.ec("ngIf",t.showDay),s.zb(2),s.ec("ngIf",!t.showDay),s.zb(1),s.ec("ngIf",t.showDay),s.zb(15),s.qc(" ",s.bc(22,7,null==t.currentEvent?null:t.currentEvent.startStr,"fullDate")," "),s.zb(5),s.rc(" ",s.bc(27,10,null==t.currentEvent?null:t.currentEvent.startStr,"shortTime")," - ",s.bc(28,13,null==t.currentEvent?null:t.currentEvent.endStr,"shortTime")," "),s.zb(6),s.qc(" ",null==t.currentEvent?null:t.currentEvent.duration," minutes "))},directives:[o.k,c.a],pipes:[o.d],styles:[".modal[_ngcontent-%COMP%]{padding:2rem;-webkit-animation:fade_in .32s cubic-bezier(.45,.19,.13,1.26) forwards;animation:fade_in .32s cubic-bezier(.45,.19,.13,1.26) forwards}.modal-dialog[_ngcontent-%COMP%]{margin:0 auto;min-height:90vh;display:flex;align-items:center;justify-content:center}.modal-content[_ngcontent-%COMP%]{box-shadow:0 4rem 10rem -1rem rgba(87,96,109,.5);border-radius:.8rem;padding:1.5rem 2rem;border:none}.modal-title[_ngcontent-%COMP%]{text-align:center}.modal[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background-color:transparent;color:#000}input[type=file][_ngcontent-%COMP%]{display:none}.form[_ngcontent-%COMP%]{max-width:45rem;width:100%;text-align:center}.form-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;min-height:100vh;overflow:hidden;background-color:#dfe6f6;padding:15rem 0 5rem;position:relative}@media (max-width:47.99em){.form-wrapper[_ngcontent-%COMP%]{padding-top:20rem}}.form-header[_ngcontent-%COMP%]{text-align:center;opacity:0;position:relative;z-index:10;-webkit-animation:fade_up .3s cubic-bezier(.25,.46,.45,.94) forwards;animation:fade_up .3s cubic-bezier(.25,.46,.45,.94) forwards;-webkit-animation-delay:.2s;animation-delay:.2s}.form-card[_ngcontent-%COMP%]{box-shadow:0 2rem 5rem 0 rgba(123,136,153,.25);border-radius:1rem;padding:3rem 3rem 4rem;background-color:#fff;position:relative;z-index:5;-webkit-animation:fade_up .5s cubic-bezier(.45,.19,.13,1.26) forwards;animation:fade_up .5s cubic-bezier(.45,.19,.13,1.26) forwards}.form-input[_ngcontent-%COMP%]{display:block;width:100%;margin:0 auto 3rem;padding:1rem 2rem;background-color:#eef4ff;outline:none!important;font-family:Inter;transition:all .3s cubic-bezier(.25,.46,.45,.94);border:none;border-bottom:1.2px solid transparent}.form-input[_ngcontent-%COMP%]::-webkit-input-placeholder{opacity:.7}.form-input[_ngcontent-%COMP%]:focus{border-color:#1ac293;box-shadow:0 2rem 5rem 0 rgba(123,136,153,.25)}.form-text[_ngcontent-%COMP%]{margin-top:2rem;color:#858585}.form-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#202020;font-weight:700}.form-bg--1[_ngcontent-%COMP%]{width:40rem;opacity:.4;transform:translate(10%,20%)}.form-circle[_ngcontent-%COMP%]{top:12vh;right:28vw;width:30rem;height:30rem}.form-circle-1[_ngcontent-%COMP%]{width:40rem;height:40rem;opacity:.1;border-radius:50%;border:1.5px solid #202020;transform:translate(30%,-40%)}select[_ngcontent-%COMP%]{-moz-appearance:none;-webkit-appearance:none;appearance:none;background-image:url(\"data:image/svg+xml;utf8,<svg fill='black' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/><path d='M0 0h24v24H0z' fill='none'/></svg>\");background-repeat:no-repeat;background-position-x:99%;background-position-y:7px}.calendar-container[_ngcontent-%COMP%]{background-color:#fff;padding:4rem 2rem;border-radius:1rem}"]}),p),g=n("tyNb"),w=n("PN1e"),k=n("PjKf"),y=n("5E5Q"),O=n("ogxq");c.b.registerPlugins([w.b,k.a,y.a,O.a]);var C,E=[{path:"",component:v}],x=((C=function e(){_classCallCheck(this,e)}).\u0275mod=s.Hb({type:C}),C.\u0275inj=s.Gb({factory:function(e){return new(e||C)},imports:[[o.b,c.b,g.f.forChild(E)]]}),C)}}]);