(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{pBEy:function(t,e,n){"use strict";n.r(e),n.d(e,"AddSlotModule",(function(){return E}));var o=n("ofXK"),i=n("PSD3"),r=n.n(i),a=n("3Pt+"),s=n("fXoL"),d=n("N+K7"),l=n("CNll"),c=n("IvIE");const b=["monthCalendar"],u=["dayCalendar"];function m(t,e){if(1&t){const t=s.Pb();s.Ob(0,"button",19),s.Wb("click",(function(){return s.kc(t),s.Yb().showDay=!1})),s.pc(1," Go Back "),s.Nb()}}function h(t,e){if(1&t&&s.Kb(0,"full-calendar",20,21),2&t){const t=s.Yb();s.ec("options",t.calendarOptionsMonth)}}function p(t,e){if(1&t&&s.Kb(0,"full-calendar",20,22),2&t){const t=s.Yb();s.ec("options",t.calendarOptionsDay)}}let f=(()=>{class t{constructor(t,e){this.http=t,this.share=e,this.form=new a.e({adminId:new a.c(this.share.user,{validators:[a.p.required]}),date:new a.c(null,{validators:[a.p.required]}),startTime:new a.c(null,{validators:[a.p.required]}),endTime:new a.c(null,{validators:[a.p.required]}),startTimeStr:new a.c(null,{validators:[a.p.required]}),endTimeStr:new a.c(null,{validators:[a.p.required]}),duration:new a.c(null,{validators:[a.p.required]}),title:new a.c(null,{validators:[a.p.required]})}),this.selectedDate="",this.bookedEvents=[],this.monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sepr","Oct","Novr","Dec"],this.calendarOptionsMonth={headerToolbar:{left:"prev,next today",center:"title",right:"dayGridMonth,listMonth"},initialView:"dayGridMonth",eventClick:this.deleteEvent.bind(this),dateClick:this.dateClick.bind(this),eventTimeFormat:{hour:"2-digit",minute:"2-digit",meridiem:!0},displayEventEnd:!0,events:this.bookedEvents},this.calendarOptionsDay={initialDate:this.selectedDate,initialView:"timeGridDay",editable:!0,selectable:!0,select:this.selectTime.bind(this),eventClick:this.deleteEvent.bind(this),events:this.bookedEvents,slotDuration:"00:50:00"}}ngOnInit(){this.showDay=!1,this.http.postToBackend("/admin/slot/all",{adminId:this.share.user}).then(t=>{console.log("original",t),this.bookedEvents=t.data.map(t=>({id:t.id,date:new Date(t.date),booked:t.booked,title:t.booked?t.title+" (Booked)":t.title,transactionId:t.booked?t.transactionId:null,start:t.startTime,end:t.endTime,allDay:!1})),this.calendarOptionsMonth.events=this.bookedEvents,this.calendarOptionsDay.events=this.bookedEvents,console.log("converted",this.bookedEvents)})}dateClick(t){this.currentDate=t.date,this.selectedDate=t.dateStr,this.calendarOptionsDay.initialDate=this.selectedDate,this.showDay=!0}selectTime(t){this.currentEvent=t,this.currentEvent.date=this.currentDate,this.currentEvent.booked=!1,this.calendarApi=t.view.calendar,this.calendarApi.unselect(),console.log("current event - ",this.currentEvent);let e=this.findDuration(this.currentEvent.startStr,this.currentEvent.endStr);this.currentEvent.duration=e,50==e?$("#slot-modal").modal("toggle"):r.a.fire("Invalid Slot","Slot duration can only be of 50 minutes.","error")}addSlot(){$("#confirm-btn").addClass("running"),$("#confirm-btn").prop("disabled",!0);let t=this.currentEvent.start.getMonth(),e=this.currentEvent.start.getYear(),n=1;this.bookedEvents.forEach(o=>{o.date.getMonth()==t&&o.date.getYear()==e&&n++}),this.form.patchValue({date:this.currentEvent.date,title:`${this.monthNames[t]} Slot - ${n}`,startTimeStr:this.currentEvent.startStr,endTimeStr:this.currentEvent.endStr,duration:this.currentEvent.duration,startTime:this.currentEvent.start,endTime:this.currentEvent.end}),this.currentEvent.title=`${this.monthNames[t]} Slot - ${n}`,console.log("this form",this.form.value),this.http.postToBackend("/admin/slot/create",this.form.value).then(t=>{$("#confirm-btn").removeClass("running"),$("#confirm-btn").prop("disabled",!1),$("#slot-modal").modal("toggle"),console.log(t),7e3==t.statusCode?(r.a.fire({icon:"success",title:"Slot Created"}),this.bookedEvents.push(this.currentEvent),this.calendarApi.addEvent(this.currentEvent)):r.a.fire({icon:"error",title:"Oops",text:t.message})}).catch(t=>{console.log(t),$("#confirm-btn").removeClass("running"),$("#confirm-btn").prop("disabled",!1),$("#slot-modal").modal("toggle"),r.a.fire({icon:"error",title:"Can't create a slot",text:t.message})})}deleteEvent(t){this.calendarApi=t.view.calendar,this.calendarApi.unselect();let e=t.event._def.publicId;var n=this.bookedEvents.findIndex(e=>e.id==t.event._def.publicId);this.bookedEvents.splice(n,1);let o=this.calendarApi.getEventById(e),i=o._def.extendedProps.transactionId;o._def.extendedProps.booked?r.a.fire({icon:"question",title:"Delete this slot?",text:"This slot is booked. Removing it will require refund for the slot. Do you still want to remove it?",showCancelButton:!0,confirmButtonText:"Yes, delete this slot!"}).then(t=>{t.value&&this.http.postToBackend("/admin/refund",{adminId:this.share.user,slotId:e,transactionId:i}).then(t=>{console.log(t),7e3===t.statusCode?(this.bookedEvents.splice(n,1),o.remove(),r.a.fire("Deleted","Slot deleted successfully. Refund Initiated","success")):r.a.fire("Failed!",t.message,"error")}).catch(t=>{console.log(t),r.a.fire("Oops",t.message,"error")})}):r.a.fire({icon:"question",title:"Delete this slot?",showCancelButton:!0,confirmButtonText:"Yes, delete this slot!"}).then(t=>{t.value&&this.http.postToBackend("/admin/slot/delete",{adminId:this.share.user,slotId:e}).then(t=>{console.log(t),t.statusCode?(r.a.fire("Deleted","Slot Deleted Successfully","success"),this.bookedEvents.splice(n,1),o.remove()):r.a.fire("Failed","Failed to delete slot","error")}).catch(t=>{console.log(t),r.a.fire("Failed","Failed to delete slot","error")}),console.log(t.value,e)})}findDuration(t,e){let n=new Date(t);var o=(new Date(e).getTime()-n.getTime())/1e3;return Math.abs(Math.round(o/=60))}}return t.\u0275fac=function(e){return new(e||t)(s.Jb(d.a),s.Jb(l.a))},t.\u0275cmp=s.Db({type:t,selectors:[["app-add-slot"]],viewQuery:function(t,e){var n;1&t&&(s.uc(b,!0),s.uc(u,!0)),2&t&&(s.ic(n=s.Xb())&&(e.monthCalendar=n.first),s.ic(n=s.Xb())&&(e.dayCalendar=n.first))},decls:39,vars:16,consts:[[1,"d-flex","align-items-center","justify-content-between","mb-5"],[1,"text-dark","text-center"],["class","btn btn-sm btn-dark mt-0",3,"click",4,"ngIf"],[1,"calendar-container"],[3,"options",4,"ngIf"],["id","slot-modal",1,"modal"],[1,"modal-dialog","modal-md"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title","text-dark","text-center"],["type","button","data-dismiss","modal",1,"close"],[1,"modal-body","text-center"],[1,"text","mb-2"],[1,"text-700"],[1,"text","mb-5"],[1,"modal-footer"],["type","button","id","confirm-btn",1,"btn","btn-sm","btn-primary","ld-ext-right",3,"click"],[1,"ld","ld-ring","ld-spin-fast"],["type","button","data-dismiss","modal",1,"btn","btn-sm","btn-dark"],[1,"btn","btn-sm","btn-dark","mt-0",3,"click"],[3,"options"],["monthCalendar",""],["dayCalendar",""]],template:function(t,e){1&t&&(s.Ob(0,"div",0),s.Ob(1,"h3",1),s.pc(2," Add new meeting slots "),s.Nb(),s.oc(3,m,2,0,"button",2),s.Nb(),s.Ob(4,"div",3),s.oc(5,h,2,1,"full-calendar",4),s.oc(6,p,2,1,"full-calendar",4),s.Nb(),s.Ob(7,"div",5),s.Ob(8,"div",6),s.Ob(9,"div",7),s.Ob(10,"div",8),s.Ob(11,"h4",9),s.pc(12,"Add this slot ?"),s.Nb(),s.Ob(13,"button",10),s.pc(14,"\xd7"),s.Nb(),s.Nb(),s.Ob(15,"div",11),s.Ob(16,"h5",1),s.pc(17," Slot Timings "),s.Nb(),s.Ob(18,"p",12),s.Ob(19,"span",13),s.pc(20,"Date: "),s.Nb(),s.pc(21),s.Zb(22,"date"),s.Nb(),s.Ob(23,"p",14),s.Ob(24,"span",13),s.pc(25,"Time: "),s.Nb(),s.pc(26),s.Zb(27,"date"),s.Zb(28,"date"),s.Nb(),s.Ob(29,"p",14),s.Ob(30,"span",13),s.pc(31,"Duration: "),s.Nb(),s.pc(32),s.Nb(),s.Nb(),s.Ob(33,"div",15),s.Ob(34,"button",16),s.Wb("click",(function(){return e.addSlot()})),s.Kb(35,"div",17),s.pc(36," Confirm this slot"),s.Nb(),s.Ob(37,"button",18),s.pc(38,"No"),s.Nb(),s.Nb(),s.Nb(),s.Nb(),s.Nb()),2&t&&(s.zb(3),s.ec("ngIf",e.showDay),s.zb(2),s.ec("ngIf",!e.showDay),s.zb(1),s.ec("ngIf",e.showDay),s.zb(15),s.rc(" ",s.bc(22,7,null==e.currentEvent?null:e.currentEvent.startStr,"fullDate")," "),s.zb(5),s.sc(" ",s.bc(27,10,null==e.currentEvent?null:e.currentEvent.startStr,"shortTime")," - ",s.bc(28,13,null==e.currentEvent?null:e.currentEvent.endStr,"shortTime")," "),s.zb(6),s.rc(" ",null==e.currentEvent?null:e.currentEvent.duration," minutes "))},directives:[o.k,c.a],pipes:[o.d],styles:[".modal[_ngcontent-%COMP%]{padding:2rem;-webkit-animation:fade_in .32s cubic-bezier(.45,.19,.13,1.26) forwards;animation:fade_in .32s cubic-bezier(.45,.19,.13,1.26) forwards}.modal-dialog[_ngcontent-%COMP%]{margin:0 auto;min-height:90vh;display:flex;align-items:center;justify-content:center}.modal-content[_ngcontent-%COMP%]{box-shadow:0 4rem 10rem -1rem rgba(87,96,109,.5);border-radius:.8rem;padding:1.5rem 2rem;border:none}.modal-title[_ngcontent-%COMP%]{text-align:center}.modal[_ngcontent-%COMP%]   .close[_ngcontent-%COMP%]{background-color:transparent;color:#000}input[type=file][_ngcontent-%COMP%]{display:none}.form[_ngcontent-%COMP%]{max-width:45rem;width:100%;text-align:center}.form-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;flex-direction:column;min-height:100vh;overflow:hidden;background-color:#dfe6f6;padding:15rem 0 5rem;position:relative}@media (max-width:47.99em){.form-wrapper[_ngcontent-%COMP%]{padding-top:20rem}}.form-header[_ngcontent-%COMP%]{text-align:center;opacity:0;position:relative;z-index:10;-webkit-animation:fade_up .3s cubic-bezier(.25,.46,.45,.94) forwards;animation:fade_up .3s cubic-bezier(.25,.46,.45,.94) forwards;-webkit-animation-delay:.2s;animation-delay:.2s}.form-card[_ngcontent-%COMP%]{box-shadow:0 2rem 5rem 0 rgba(123,136,153,.25);border-radius:1rem;padding:3rem 3rem 4rem;background-color:#fff;position:relative;z-index:5;-webkit-animation:fade_up .5s cubic-bezier(.45,.19,.13,1.26) forwards;animation:fade_up .5s cubic-bezier(.45,.19,.13,1.26) forwards}.form-input[_ngcontent-%COMP%]{display:block;width:100%;margin:0 auto 3rem;padding:1rem 2rem;background-color:#eef4ff;outline:none!important;font-family:Inter;transition:all .3s cubic-bezier(.25,.46,.45,.94);border:none;border-bottom:1.2px solid transparent}.form-input[_ngcontent-%COMP%]::-webkit-input-placeholder{opacity:.7}.form-input[_ngcontent-%COMP%]:focus{border-color:#1ac293;box-shadow:0 2rem 5rem 0 rgba(123,136,153,.25)}.form-text[_ngcontent-%COMP%]{margin-top:2rem;color:#858585}.form-text[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#202020;font-weight:700}.form-bg--1[_ngcontent-%COMP%]{width:40rem;opacity:.4;transform:translate(10%,20%)}.form-circle[_ngcontent-%COMP%]{top:12vh;right:28vw;width:30rem;height:30rem}.form-circle-1[_ngcontent-%COMP%]{width:40rem;height:40rem;opacity:.1;border-radius:50%;border:1.5px solid #202020;transform:translate(30%,-40%)}select[_ngcontent-%COMP%]{-moz-appearance:none;-webkit-appearance:none;appearance:none;background-image:url(\"data:image/svg+xml;utf8,<svg fill='black' height='24' viewBox='0 0 24 24' width='24' xmlns='http://www.w3.org/2000/svg'><path d='M7 10l5 5 5-5z'/><path d='M0 0h24v24H0z' fill='none'/></svg>\");background-repeat:no-repeat;background-position-x:99%;background-position-y:7px}.calendar-container[_ngcontent-%COMP%]{background-color:#fff;padding:4rem 2rem;border-radius:1rem}"]}),t})();var g=n("tyNb"),v=n("PN1e"),w=n("PjKf"),k=n("5E5Q"),O=n("ogxq");c.b.registerPlugins([v.b,w.a,k.a,O.a]);const y=[{path:"",component:f}];let E=(()=>{class t{}return t.\u0275mod=s.Hb({type:t}),t.\u0275inj=s.Gb({factory:function(e){return new(e||t)},imports:[[o.b,c.b,g.f.forChild(y)]]}),t})()}}]);